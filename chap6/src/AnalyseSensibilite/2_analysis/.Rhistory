y = "Fréquence")
histo
randomness <- valeurs_reduites %>%
gather(Indicateur, valeur, -sensibility_parameter, -sensibility_value, -type) %>%
mutate(Indicateur = str_remove(Indicateur, "_normalise")) %>%
mutate(valeur = as.numeric(valeur)) %>%
group_by(sensibility_parameter, sensibility_value, Indicateur) %>%
summarise(ecartype = sd(valeur, na.rm = TRUE)) %>%
ungroup() %>%
mutate(sensibility_parameter = str_replace_all(sensibility_parameter, "_", " ")) %>%
mutate(indicateur_ordre = case_when(
Indicateur == "nb_agregats" ~ 1,
Indicateur == "nb_grands_chateaux" ~ 2,
Indicateur == "nb_eglises_paroissiales" ~ 3,
Indicateur == "distance_eglises_paroissiales" ~ 4,
Indicateur == "prop_fp_isoles" ~ 5,
Indicateur == "ratio_charge_fiscale" ~ 6,
)) %>%
mutate(Indicateur = fct_recode(as.factor(Indicateur),
"Nombre\nd'agrégats" = "nb_agregats",
"Nombre de\ngrands\nchâteaux" = 'nb_grands_chateaux',
"Nombre\nd'églises\nparoissiales" = "nb_eglises_paroissiales",
"Distance\nentre\néglises" = "distance_eglises_paroissiales",
"Taux de\nfoyers paysans\nisolés" = "prop_fp_isoles",
"Augmentation\nde la charge\nfiscale" = "ratio_charge_fiscale"
))  %>%
mutate(Indicateur = fct_reorder(Indicateur, indicateur_ordre)) %>%
select(-indicateur_ordre)
foo <- ggplot(randomness %>%
filter(ecartype > 1.666) %>%
mutate(sensibility_parameter = fct_reorder(sensibility_parameter, ecartype, .desc = FALSE))
) +
aes(sensibility_value, ecartype, fill = Indicateur) +
geom_col(width = .5, position = position_dodge()) +
facet_grid(Indicateur~sensibility_parameter, scales = "free_x",labeller = label_wrap_gen(width=8)) +
scale_fill_viridis_d() +
labs(title = "Valeurs de paramètres présentant les plus fortes variabilités à l'aléa",
subtitle = "Les valeurs isolées sont celles qui présentent un écart-type supérieur de 66.6% à l'écart-type des simulations calibrées",
x = "Valeurs de paramètres",
y = "Écart-type des réplications") +
guides(fill = FALSE) +
theme(axis.text.x = element_text(angle = 45, size = 8, vjust = 1, hjust = 1),
axis.title.x = element_text(margin = margin(t = -16, unit = "pt")),
strip.text.y = element_text(margin = margin(l = 2, r = 2, unit = "pt")))
foo
ggsave(foo, filename = "../3_results/sensiblite_alea.pdf", width = 20, height = 15, units = "cm", scale = 1.5)
histo <- ggplot(randomness) +
aes(ecartype) +
geom_histogram(aes(fill = Indicateur), binwidth = 0.1) +
facet_wrap(~Indicateur, nrow = 1, labeller = label_wrap_gen(width = 12)) +
guides(fill = FALSE) +
scale_fill_viridis_d(end = 0.8) +
labs(title = "Distribution de la sensibilité à l'aléa",
x = "Incertitude des simulations",
y = "Fréquence")
histo
ggsave(histo, filename = "../3_results/histo_sensibilite_alea.pdf", width = 20, height = 8, units = "cm", scale = 1)
histo <- ggplot(randomness) +
aes(ecartype) +
geom_histogram(aes(fill = Indicateur), binwidth = 0.1) +
facet_wrap(~Indicateur, nrow = 1, labeller = label_wrap_gen(width = 15)) +
guides(fill = FALSE) +
scale_fill_viridis_d(end = 0.8) +
labs(title = "Distribution de la sensibilité à l'aléa",
x = "Incertitude des simulations",
y = "Fréquence")
histo
ggsave(histo, filename = "../3_results/histo_sensibilite_alea.pdf", width = 20, height = 8, units = "cm", scale = 1)
histo <- ggplot(randomness) +
aes(ecartype) +
geom_histogram(aes(fill = Indicateur), binwidth = 0.1) +
facet_wrap(~Indicateur, nrow = 1, labeller = label_wrap_gen(width = 20)) +
guides(fill = FALSE) +
scale_fill_viridis_d(end = 0.8) +
labs(title = "Distribution de la sensibilité à l'aléa",
x = "Incertitude des simulations",
y = "Fréquence")
histo
ggsave(histo, filename = "../3_results/histo_sensibilite_alea.pdf", width = 20, height = 8, units = "cm", scale = 1)
ggsave(histo, filename = "../3_results/histo_sensibilite_alea.pdf", width = 20, height = 7, units = "cm", scale = 1)
histo <- ggplot(randomness) +
aes(ecartype) +
geom_histogram(aes(fill = Indicateur), binwidth = 0.1) +
facet_wrap(~Indicateur, nrow = 1, labeller = label_wrap_gen(width = 20)) +
guides(fill = FALSE) +
scale_fill_viridis_d(end = 0.8) +
labs(title = "Distribution de la sensibilité à l'aléa",
x = "Incertitude des simulations",
y = "Fréquence") +
theme_light()
histo
ggsave(histo, filename = "../3_results/histo_sensibilite_alea.pdf", width = 20, height = 7, units = "cm", scale = 1)
foo <- ggplot(randomness %>%
filter(ecartype > 1.666) %>%
mutate(sensibility_parameter = fct_reorder(sensibility_parameter, ecartype, .desc = FALSE))
) +
aes(sensibility_value, ecartype, fill = Indicateur) +
geom_col(width = .5, position = position_dodge()) +
facet_grid(Indicateur~sensibility_parameter, scales = "free_x",labeller = label_wrap_gen(width=8)) +
scale_fill_viridis_d() +
labs(title = "Valeurs de paramètres présentant les plus fortes variabilités à l'aléa",
subtitle = "Les valeurs isolées sont celles qui présentent un écart-type supérieur de 66.6% à l'écart-type des simulations calibrées",
x = "Valeurs de paramètres",
y = "Écart-type des réplications") +
guides(fill = FALSE) +
theme_light() +
theme(axis.text.x = element_text(angle = 45, size = 8, vjust = 1, hjust = 1),
axis.title.x = element_text(margin = margin(t = -16, unit = "pt")),
strip.text.y = element_text(margin = margin(l = 2, r = 2, unit = "pt")))
foo
foo <- ggplot(randomness %>%
filter(ecartype > 1.666) %>%
mutate(sensibility_parameter = fct_reorder(sensibility_parameter, ecartype, .desc = FALSE))
) +
aes(sensibility_value, ecartype, fill = Indicateur) +
geom_col(width = .5, position = position_dodge()) +
facet_grid(Indicateur~sensibility_parameter, scales = "free_x",labeller = label_wrap_gen(width=8)) +
scale_fill_viridis_d() +
labs(title = "Valeurs de paramètres présentant les plus fortes variabilités à l'aléa",
subtitle = "Les valeurs isolées sont celles qui présentent un écart-type supérieur de 66.6% à l'écart-type des simulations calibrées",
x = "Valeurs de paramètres",
y = "Écart-type des réplications") +
guides(fill = FALSE) +
theme_light() +
theme(axis.text.x = element_text(angle = 45, size = 8, vjust = 1, hjust = 1),
axis.title.x = element_text(margin = margin(t = -16, unit = "pt")),
strip.text.y = element_text(margin = margin(l = 2, r = 2, unit = "pt")),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank()
)
foo
foo <- ggplot(randomness %>%
filter(ecartype > 1.666) %>%
mutate(sensibility_parameter = fct_reorder(sensibility_parameter, ecartype, .desc = FALSE))
) +
aes(sensibility_value, ecartype, fill = Indicateur) +
geom_col(width = .5, position = position_dodge()) +
facet_grid(Indicateur~sensibility_parameter, scales = "free_x",labeller = label_wrap_gen(width=8)) +
scale_fill_viridis_d() +
labs(title = "Valeurs de paramètres présentant les plus fortes variabilités à l'aléa",
subtitle = "Les valeurs isolées sont celles qui présentent un écart-type supérieur de 66.6% à l'écart-type des simulations calibrées",
x = "Valeurs de paramètres",
y = "Écart-type des réplications") +
guides(fill = FALSE) +
theme_light() +
theme(axis.text.x = element_text(angle = 45, size = 8, vjust = 1, hjust = 1),
axis.title.x = element_text(margin = margin(t = -16, unit = "pt")),
strip.text.y = element_text(margin = margin(l = 2, r = 2, unit = "pt")),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.minor.y = element_blank()
)
foo
ggsave(foo, filename = "../3_results/sensiblite_alea.pdf", width = 20, height = 15, units = "cm", scale = 1.5)
ggsave(foo, filename = "../3_results/sensiblite_alea.pdf", width = 20, height = 15, units = "cm", scale = 1.6)
ggsave(foo, filename = "../3_results/sensiblite_alea.pdf", width = 20, height = 15, units = "cm", scale = 1.65)
?labeller
foo <- ggplot(randomness %>%
filter(ecartype > 1.666) %>%
mutate(sensibility_parameter = fct_reorder(sensibility_parameter, ecartype, .desc = FALSE))
) +
aes(sensibility_value, ecartype, fill = Indicateur) +
geom_col(width = .5, position = position_dodge()) +
facet_grid(Indicateur~sensibility_parameter, scales = "free_x",labeller = labeller(
.rows = label_wrap_gen(width = 15),
.cols = label_wrap_gen(width = 8))
)+
scale_fill_viridis_d() +
labs(title = "Valeurs de paramètres présentant les plus fortes variabilités à l'aléa",
subtitle = "Les valeurs isolées sont celles qui présentent un écart-type supérieur de 66.6% à l'écart-type des simulations calibrées",
x = "Valeurs de paramètres",
y = "Écart-type des réplications") +
guides(fill = FALSE) +
theme_light() +
theme(axis.text.x = element_text(angle = 45, size = 8, vjust = 1, hjust = 1),
axis.title.x = element_text(margin = margin(t = -16, unit = "pt")),
strip.text.y = element_text(margin = margin(l = 2, r = 2, unit = "pt")),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.minor.y = element_blank()
)
foo
ggsave(foo, filename = "../3_results/sensiblite_alea.pdf", width = 20, height = 15, units = "cm", scale = 1.65)
foo <- ggplot(randomness %>%
filter(ecartype > 1.666) %>%
mutate(sensibility_parameter = fct_reorder(sensibility_parameter, ecartype, .desc = FALSE))
) +
aes(sensibility_value, ecartype, fill = Indicateur) +
geom_col(width = .5, position = position_dodge()) +
facet_grid(Indicateur~sensibility_parameter, scales = "free_x",labeller = labeller(
.rows = label_wrap_gen(width = 20),
.cols = label_wrap_gen(width = 8))
)+
scale_fill_viridis_d() +
labs(title = "Valeurs de paramètres présentant les plus fortes variabilités à l'aléa",
subtitle = "Les valeurs isolées sont celles qui présentent un écart-type supérieur de 66.6% à l'écart-type des simulations calibrées",
x = "Valeurs de paramètres",
y = "Écart-type des réplications") +
guides(fill = FALSE) +
theme_light() +
theme(axis.text.x = element_text(angle = 45, size = 8, vjust = 1, hjust = 1),
axis.title.x = element_text(margin = margin(t = -16, unit = "pt")),
strip.text.y = element_text(margin = margin(l = 2, r = 2, unit = "pt")),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.minor.y = element_blank()
)
ggsave(foo, filename = "../3_results/sensiblite_alea.pdf", width = 20, height = 15, units = "cm", scale = 1.65)
randomness
randomness
randomness %>%
filter(
(Indicateur == "Nombre\nd'agrégats" & (ecartype > 1.5 | ecatype < 0.5)) |
(Indicateur == "Nombre de\ngrands\nchâteaux" & ecartype > 2) |
(Indicateur == "Nombre\nd'églises\nparoissiales" & ecartype > 1.8) |
(Indicateur == "Distance\nentre\néglises" & ecartype > 1.6) |
(Indicateur == "Taux de\nfoyers paysans\nisolés" & ecartype < 0.5) |
(Indicateur == "Augmentation\nde la charge\nfiscale" & ecartype > 1.5)
)
randomness %>%
filter(
(Indicateur == "Nombre\nd'agrégats" & (ecartype > 1.5 | ecartype < 0.5)) |
(Indicateur == "Nombre de\ngrands\nchâteaux" & ecartype > 2) |
(Indicateur == "Nombre\nd'églises\nparoissiales" & ecartype > 1.8) |
(Indicateur == "Distance\nentre\néglises" & ecartype > 1.6) |
(Indicateur == "Taux de\nfoyers paysans\nisolés" & ecartype < 0.5) |
(Indicateur == "Augmentation\nde la charge\nfiscale" & ecartype > 1.5)
)
randomness %>%
filter(
(Indicateur == "Nombre\nd'agrégats" & (ecartype > 1.5 | ecartype < 0.5)) |
(Indicateur == "Nombre de\ngrands\nchâteaux" & ecartype > 2) |
(Indicateur == "Nombre\nd'églises\nparoissiales" & ecartype > 1.8) |
(Indicateur == "Distance\nentre\néglises" & ecartype > 1.6) |
(Indicateur == "Taux de\nfoyers paysans\nisolés" & ecartype < 0.5) |
(Indicateur == "Augmentation\nde la charge\nfiscale" & ecartype > 1.5)
) %>%
mutate(sensibility_parameter = fct_reorder(sensibility_parameter, ecartype, .desc = FALSE)) %>%
ggplot() +
aes(sensibility_value, ecartype, fill = Indicateur) +
geom_col(width = .5, position = position_dodge()) +
facet_grid(Indicateur~sensibility_parameter, scales = "free_x",labeller = labeller(
.rows = label_wrap_gen(width = 20),
.cols = label_wrap_gen(width = 8))
)+
scale_fill_viridis_d() +
labs(title = "Valeurs de paramètres présentant les plus fortes variabilités à l'aléa",
subtitle = "Les valeurs isolées sont celles qui présentent un écart-type supérieur de 66.6% à l'écart-type des simulations calibrées",
x = "Valeurs de paramètres",
y = "Écart-type des réplications") +
guides(fill = FALSE) +
theme_light() +
theme(axis.text.x = element_text(angle = 45, size = 8, vjust = 1, hjust = 1),
axis.title.x = element_text(margin = margin(t = -16, unit = "pt")),
strip.text.y = element_text(margin = margin(l = 2, r = 2, unit = "pt")),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.minor.y = element_blank()
)
alea_new <- randomness %>%
filter(
(Indicateur == "Nombre\nd'agrégats" & (ecartype > 1.5 | ecartype < 0.5)) |
(Indicateur == "Nombre de\ngrands\nchâteaux" & ecartype > 2) |
(Indicateur == "Nombre\nd'églises\nparoissiales" & ecartype > 1.8) |
(Indicateur == "Distance\nentre\néglises" & ecartype > 1.6) |
(Indicateur == "Taux de\nfoyers paysans\nisolés" & ecartype < 0.5) |
(Indicateur == "Augmentation\nde la charge\nfiscale" & ecartype > 1.5)
) %>%
mutate(sensibility_parameter = fct_reorder(sensibility_parameter, ecartype, .desc = FALSE)) %>%
ggplot() +
aes(sensibility_value, ecartype, fill = Indicateur) +
geom_col(width = .5, position = position_dodge()) +
facet_grid(Indicateur~sensibility_parameter, scales = "free_x",labeller = labeller(
.rows = label_wrap_gen(width = 20),
.cols = label_wrap_gen(width = 8))
)+
scale_fill_viridis_d() +
labs(title = "Valeurs de paramètres présentant les plus fortes variabilités à l'aléa",
subtitle = "Les valeurs isolées sont celles qui présentent un écart-type supérieur de 66.6% à l'écart-type des simulations calibrées",
x = "Valeurs de paramètres",
y = "Écart-type des réplications") +
guides(fill = FALSE) +
theme_light() +
theme(axis.text.x = element_text(angle = 45, size = 8, vjust = 1, hjust = 1),
axis.title.x = element_text(margin = margin(t = -16, unit = "pt")),
strip.text.y = element_text(margin = margin(l = 2, r = 2, unit = "pt")),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.minor.y = element_blank()
)
alea_new <- randomness %>%
filter(
(Indicateur == "Nombre\nd'agrégats" & (ecartype > 1.5 | ecartype < 0.5)) |
(Indicateur == "Nombre de\ngrands\nchâteaux" & ecartype > 2) |
(Indicateur == "Nombre\nd'églises\nparoissiales" & ecartype > 1.8) |
(Indicateur == "Distance\nentre\néglises" & ecartype > 1.6) |
(Indicateur == "Taux de\nfoyers paysans\nisolés" & ecartype < 0.5) |
(Indicateur == "Augmentation\nde la charge\nfiscale" & ecartype > 1.5)
) %>%
mutate(sensibility_parameter = fct_reorder(sensibility_parameter, ecartype, .desc = FALSE)) %>%
ggplot() +
aes(sensibility_value, ecartype, fill = Indicateur) +
geom_col(width = .5, position = position_dodge()) +
facet_grid(Indicateur~sensibility_parameter, scales = "free_x",labeller = labeller(
.rows = label_wrap_gen(width = 20),
.cols = label_wrap_gen(width = 8))
)+
scale_fill_viridis_d() +
labs(title = "Valeurs de paramètres présentant les plus fortes variabilités à l'aléa",
subtitle = "Les valeurs isolées sont celles qui présentent un écart-type supérieur de 66.6% à l'écart-type des simulations calibrées",
x = "Valeurs de paramètres",
y = "Écart-type des réplications") +
guides(fill = FALSE) +
theme_light() +
theme(axis.text.x = element_text(angle = 45, size = 8, vjust = 1, hjust = 1),
axis.title.x = element_text(margin = margin(t = -16, unit = "pt")),
strip.text.y = element_text(margin = margin(l = 2, r = 2, unit = "pt")),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.minor.y = element_blank()
)
ggsave(alea_new, filename = "../3_results/sensiblite_alea_outliers.pdf", width = 20, height = 15, units = "cm", scale = 1.65)
ggsave(alea_new, filename = "../3_results/sensiblite_alea_outliers.pdf", width = 20, height = 15, units = "cm", scale = 1.3)
alea_new <- randomness %>%
filter(
(Indicateur == "Nombre\nd'agrégats" & (ecartype > 1.5 | ecartype < 0.5)) |
(Indicateur == "Nombre de\ngrands\nchâteaux" & ecartype > 2) |
(Indicateur == "Nombre\nd'églises\nparoissiales" & ecartype > 1.8) |
(Indicateur == "Distance\nentre\néglises" & ecartype > 1.6) |
(Indicateur == "Taux de\nfoyers paysans\nisolés" & ecartype < 0.5) |
(Indicateur == "Augmentation\nde la charge\nfiscale" & ecartype > 1.5)
) %>%
mutate(sensibility_parameter = fct_reorder(sensibility_parameter, ecartype, .desc = FALSE)) %>%
ggplot() +
aes(sensibility_value, ecartype, fill = Indicateur) +
geom_col(width = .5, position = position_dodge()) +
facet_grid(Indicateur~sensibility_parameter, scales = "free_x",labeller = labeller(
.rows = label_wrap_gen(width = 15),
.cols = label_wrap_gen(width = 8))
)+
scale_fill_viridis_d() +
labs(title = "Valeurs de paramètres présentant les plus fortes variabilités à l'aléa",
subtitle = "Les valeurs isolées sont celles qui présentent un écart-type supérieur de 66.6% à l'écart-type des simulations calibrées",
x = "Valeurs de paramètres",
y = "Écart-type des réplications") +
guides(fill = FALSE) +
theme_light() +
theme(axis.text.x = element_text(angle = 45, size = 8, vjust = 1, hjust = 1),
axis.title.x = element_text(margin = margin(t = -16, unit = "pt")),
strip.text.y = element_text(margin = margin(l = 2, r = 2, unit = "pt")),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.minor.y = element_blank()
)
ggsave(alea_new, filename = "../3_results/sensiblite_alea_outliers.pdf", width = 20, height = 15, units = "cm", scale = 1.3)
alea_new <- randomness %>%
filter(
(Indicateur == "Nombre\nd'agrégats" & (ecartype > 1.5 | ecartype < 0.5)) |
(Indicateur == "Nombre de\ngrands\nchâteaux" & ecartype > 2) |
(Indicateur == "Nombre\nd'églises\nparoissiales" & ecartype > 1.8) |
(Indicateur == "Distance\nentre\néglises" & ecartype > 1.6) |
(Indicateur == "Taux de\nfoyers paysans\nisolés" & ecartype < 0.5) |
(Indicateur == "Augmentation\nde la charge\nfiscale" & ecartype > 1.5)
) %>%
mutate(sensibility_parameter = fct_reorder(sensibility_parameter, ecartype, .desc = FALSE)) %>%
ggplot() +
aes(sensibility_value, ecartype, fill = Indicateur) +
geom_col(width = .5, position = position_dodge()) +
facet_grid(Indicateur~sensibility_parameter, scales = "free_x",labeller = labeller(
.rows = label_wrap_gen(width = 14),
.cols = label_wrap_gen(width = 8))
)+
scale_fill_viridis_d() +
labs(title = "Valeurs de paramètres présentant les plus fortes variabilités à l'aléa",
subtitle = "Les valeurs isolées sont celles qui présentent un écart-type supérieur de 66.6% à l'écart-type des simulations calibrées",
x = "Valeurs de paramètres",
y = "Écart-type des réplications") +
guides(fill = FALSE) +
theme_light() +
theme(axis.text.x = element_text(angle = 45, size = 8, vjust = 1, hjust = 1),
axis.title.x = element_text(margin = margin(t = -16, unit = "pt")),
strip.text.y = element_text(margin = margin(l = 2, r = 2, unit = "pt")),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.minor.y = element_blank()
)
ggsave(alea_new, filename = "../3_results/sensiblite_alea_outliers.pdf", width = 20, height = 15, units = "cm", scale = 1.3)
alea_new <- randomness %>%
filter(
(Indicateur == "Nombre\nd'agrégats" & (ecartype > 1.5 | ecartype < 0.5)) |
(Indicateur == "Nombre de\ngrands\nchâteaux" & ecartype > 2) |
(Indicateur == "Nombre\nd'églises\nparoissiales" & ecartype > 1.8) |
(Indicateur == "Distance\nentre\néglises" & ecartype > 1.6) |
(Indicateur == "Taux de\nfoyers paysans\nisolés" & ecartype < 0.5) |
(Indicateur == "Augmentation\nde la charge\nfiscale" & ecartype > 1.5)
) %>%
mutate(sensibility_parameter = fct_reorder(sensibility_parameter, ecartype, .desc = FALSE)) %>%
ggplot() +
aes(sensibility_value, ecartype, fill = Indicateur) +
geom_col(width = .5, position = position_dodge()) +
facet_grid(Indicateur~sensibility_parameter, scales = "free_x",labeller = labeller(
.rows = label_wrap_gen(width = 15),
.cols = label_wrap_gen(width = 8))
)+
scale_fill_viridis_d() +
labs(title = "Valeurs de paramètres présentant les plus fortes variabilités à l'aléa",
subtitle = "Les valeurs isolées sont celles qui présentent un écart-type supérieur de 66.6% à l'écart-type des simulations calibrées",
x = "Valeurs de paramètres",
y = "Écart-type des réplications") +
guides(fill = FALSE) +
theme_light() +
theme(axis.text.x = element_text(angle = 45, size = 8, vjust = 1, hjust = 1),
axis.title.x = element_text(margin = margin(t = -16, unit = "pt")),
strip.text.y = element_text(margin = margin(l = 2, r = 2, unit = "pt")),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.minor.y = element_blank()
)
ggsave(alea_new, filename = "../3_results/sensiblite_alea_outliers.pdf", width = 20, height = 15, units = "cm", scale = 1.35)
alea_new <- randomness %>%
filter(
(Indicateur == "Nombre\nd'agrégats" & (ecartype > 1.5 | ecartype < 0.5)) |
(Indicateur == "Nombre de\ngrands\nchâteaux" & ecartype > 2) |
(Indicateur == "Nombre\nd'églises\nparoissiales" & ecartype > 1.8) |
(Indicateur == "Distance\nentre\néglises" & ecartype > 1.6) |
(Indicateur == "Taux de\nfoyers paysans\nisolés" & ecartype < 0.5) |
(Indicateur == "Augmentation\nde la charge\nfiscale" & ecartype > 1.5)
) %>%
mutate(sensibility_parameter = fct_reorder(sensibility_parameter, ecartype, .desc = FALSE)) %>%
ggplot() +
aes(sensibility_value, ecartype, fill = Indicateur) +
geom_col(width = .5, position = position_dodge()) +
facet_grid(Indicateur~sensibility_parameter, scales = "free_x",labeller = labeller(
.rows = label_wrap_gen(width = 15),
.cols = label_wrap_gen(width = 8))
)+
scale_fill_viridis_d() +
labs(title = "Valeurs de paramètres présentant une variabilité à l'aléa atypique",
x = "Valeurs de paramètres",
y = "Écart-type des réplications") +
guides(fill = FALSE) +
theme_light() +
theme(axis.text.x = element_text(angle = 45, size = 8, vjust = 1, hjust = 1),
axis.title.x = element_text(margin = margin(t = -16, unit = "pt")),
strip.text.y = element_text(margin = margin(l = 2, r = 2, unit = "pt")),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.minor.y = element_blank()
)
ggsave(alea_new, filename = "../3_results/sensiblite_alea_outliers.pdf", width = 20, height = 15, units = "cm", scale = 1.35)
alea_new <- randomness %>%
filter(
(Indicateur == "Nombre\nd'agrégats" & (ecartype > 1.5 | ecartype < 0.5)) |
(Indicateur == "Nombre de\ngrands\nchâteaux" & ecartype > 2) |
(Indicateur == "Nombre\nd'églises\nparoissiales" & ecartype > 1.8) |
(Indicateur == "Distance\nentre\néglises" & ecartype > 1.6) |
(Indicateur == "Taux de\nfoyers paysans\nisolés" & ecartype < 0.5) |
(Indicateur == "Augmentation\nde la charge\nfiscale" & ecartype > 1.5)
) %>%
mutate(sensibility_parameter = fct_reorder(sensibility_parameter, ecartype, .desc = FALSE)) %>%
ggplot() +
aes(sensibility_value, ecartype, fill = Indicateur) +
geom_col(width = .5, position = position_dodge()) +
facet_grid(Indicateur~sensibility_parameter, scales = "free_x",labeller = labeller(
.rows = label_wrap_gen(width = 15),
.cols = label_wrap_gen(width = 8))
)+
scale_fill_viridis_d() +
labs(title = "Valeurs de paramètres présentant une variabilité à l'aléa atypique",
x = "Valeurs de paramètres",
y = "Rapport à l'aléa de référence (écart-type)") +
guides(fill = FALSE) +
theme_light() +
theme(axis.text.x = element_text(angle = 45, size = 8, vjust = 1, hjust = 1),
axis.title.x = element_text(margin = margin(t = -16, unit = "pt")),
strip.text.y = element_text(margin = margin(l = 2, r = 2, unit = "pt")),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.minor.y = element_blank()
)
ggsave(alea_new, filename = "../3_results/sensiblite_alea_outliers.pdf", width = 20, height = 15, units = "cm", scale = 1.35)
alea_new <- randomness %>%
filter(
(Indicateur == "Nombre\nd'agrégats" & (ecartype > 1.5 | ecartype < 0.5)) |
(Indicateur == "Nombre de\ngrands\nchâteaux" & ecartype > 2) |
(Indicateur == "Nombre\nd'églises\nparoissiales" & ecartype > 1.8) |
(Indicateur == "Distance\nentre\néglises" & ecartype > 1.6) |
(Indicateur == "Taux de\nfoyers paysans\nisolés" & ecartype < 0.5) |
(Indicateur == "Augmentation\nde la charge\nfiscale" & ecartype > 1.5)
) %>%
mutate(sensibility_parameter = fct_reorder(sensibility_parameter, ecartype, .desc = FALSE)) %>%
ggplot() +
aes(sensibility_value, ecartype, fill = Indicateur) +
geom_col(width = .5, position = position_dodge()) +
facet_grid(Indicateur~sensibility_parameter, scales = "free_x",labeller = labeller(
.rows = label_wrap_gen(width = 15),
.cols = label_wrap_gen(width = 8))
)+
scale_fill_viridis_d() +
labs(title = "Valeurs de paramètres présentant une variabilité à l'aléa atypique",
x = "Valeurs de paramètres",
y = "Rapport à la variabilité de référence (écart-type)") +
guides(fill = FALSE) +
theme_light() +
theme(axis.text.x = element_text(angle = 45, size = 8, vjust = 1, hjust = 1),
axis.title.x = element_text(margin = margin(t = -16, unit = "pt")),
strip.text.y = element_text(margin = margin(l = 2, r = 2, unit = "pt")),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.minor.y = element_blank()
)
ggsave(alea_new, filename = "../3_results/sensiblite_alea_outliers.pdf", width = 20, height = 15, units = "cm", scale = 1.35)
