%\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{graphicx}
%%%% REPRISES %%%%
%\usepackage[left=1.5cm, right=5cm,
%bottom = 1.5cm, foot = 1.25cm, footskip = .75cm,
%top = 2.25cm, headsep = .5cm, headheight=30pt
%]{geometry}
%%%% FINAL : PDF %%%%
\usepackage[left=2.5cm, right=2.5cm,
bottom = 1.5cm, foot = 1.25cm, footskip = .75cm,
top = 2.25cm, headsep = .5cm, headheight=30pt
]{geometry}
%%%% FINAL : PAPIER %%%%
%\usepackage[left=3.25cm, right=1.75cm,
%bottom = 1.5cm, foot = 1.25cm, footskip = .75cm,
%top = 2.25cm, headsep = .5cm, headheight=30pt
%]{geometry}

\setlength{\marginparwidth}{4.5cm}

\usepackage{marginnote}
\usepackage{fontspec}
\setmainfont{Charis SIL}
\usepackage{setspace}
\setstretch{1.1}
\usepackage[french]{babel}
\usepackage[babel=true]{csquotes}

\usepackage{soul}
\usepackage{mdframed}

\usepackage{xargs} % Use more than one optional parameter in a new commands
\usepackage[dvipsnames,table]{xcolor}

\usepackage{comment}

\usepackage{float}
\usepackage{caption}
\captionsetup[figure]{belowskip=-1.5em, skip=0.25em, font={small}, labelfont={bf,sc}}
\captionsetup[lstlisting]{belowskip=-1em, font=small, labelfont={bf,sc}}
\captionsetup[table]{position=below, aboveskip=1em, belowskip=-1.5em, skip=0.25em, font=small, labelfont={bf,sc}}
\usepackage{rotating}
\usepackage{rotfloat}
\def\frenchtablename{\textsc{Tableau}}
\frenchbsetup{SmallCapsFigTabCaptions=true}

\usepackage{fancyhdr}
\pagestyle{fancy}

\renewcommand{\headrulewidth}{0.5pt}
\renewcommand{\footrulewidth}{0pt}

%%% VERSION PDF %%%
%\fancyhead[L]{Chapitre \thechapter}
\fancyhead[C]{}
\fancyhead[R]{}
\fancyhead[L]{}
\fancyfoot[L]{}
\fancyfoot[C]{\thepage}
\fancyfoot[R]{}
%\fancyfoot[LO]{\thepage}
%\fancyfoot[RE]{\thepage}
%\fancyhead[R]{\nouppercase{\rightmark}}
%%% VERSION IMPRIMEE %%%


\newcommand{\FancyNotChapter}[1]{%
	\fancyhead[LE]{}
	\fancyhead[RO]{\textsc{#1}}
}
\newcommand{\FancyChapter}[0]{%
	\fancyhead[LE]{\leftmark}
	\fancyhead[RO]{\textsc{\rightmark}}
}


\usepackage{epigraph}
\setlength{\epigraphrule}{0pt}
\setlength{\epigraphwidth}{0.85\textwidth}
\renewcommand\textflush{flushepinormal}
\renewenvironment{flushepinormal}{}{\vspace*{-\baselineskip}}

\newcounter{savefootnote}
\renewcommand{\thempfootnote}{\arabic{footnote}}%

\usepackage{paralist} % apporte compactenum et compactitem
\usepackage{enumitem}
\setlist{  
	listparindent=\parindent,
	parsep=0pt,
}

\newskip\bigskipamount   \bigskipamount =20pt plus 4pt minus 4pt
\setlength{\parskip}{0.75em}
\setlength{\parindent}{0em}
\setlength{\footnotesep}{.75\baselineskip}


\usepackage{varioref}
\usepackage[hyperfootnotes=false]{hyperref}
\hypersetup{
	pdfauthor={Robin CURA},
	pdftitle={These CURA 2020},
	pdfsubject={Modéliser des systèmes de peuplement en interdisciplinarité. Co-construction et exploration visuelle d’un modèle de simulation.},
	pdfkeywords={modélisation à base d'agents, visualisation, systèmes de peuplement, temps long, interdisciplinarité, SimFeodal, SimEDB}
}
\usepackage[noabbrev, nameinlink]{cleveref}


\usepackage{longtable}
\usepackage{array}

\usepackage{fontawesome}
\usepackage{wrapfig}

\usepackage[
style=authoryear-icomp, % Permet d'avoir des ibid. en cas de répétition, mais parfois pas terrible avec les ndbp
%style=authoryear-comp,
hyperref=true,
backend=biber,
isbn=false,
doi=true,
url=true,
date=year,
uniquename=false, % sinon, ajoute prénom quand plusieurs auteurs ont le même nom
sortcites=false,  % Ne pas changer l'ordre des citations multiples
sorting=nyvt, % Citations dans biblio : NameYearVolumeTitle
%backref=true
]{biblatex}

% Forcer non ibid (nouveau compte) :
% \citereset  : juste avant deuxième occurence pour remettre à 0 le compteur
% \citetrackerfalse [...] \citetrackertrue : par exemple pour exclure ndbp
% \mancite : comme \cite{} si ça déconne



%%%% Styles chapitres %%%%
\usepackage[Bjornstrup]{fncychap}
\ChTitleVar{\raggedright\LARGE\sffamily\bfseries}


%\usepackage{natbib}

\usepackage[thinlines]{easytable}
\usepackage{makecell}
\usepackage{diagbox}
%\usepackage{colortbl}      
\usepackage{hhline}     

\renewcommand\theadalign{bc}
\renewcommand\theadfont{\bfseries}
\renewcommand\theadgape{\Gape[4pt]}
\renewcommand\cellgape{\Gape[4pt]}

\usepackage{shorttoc}
\usepackage[french, tight]{minitoc}
\dominitoc

\usepackage{listings} % Code
\lstset{
	basicstyle=\ttfamily,
	frame=single
}
%\usepackage{minted}
\renewcommand\lstlistingname{Code}
\renewcommand\lstlistlistingname{Code}
\crefformat{lstlisting}{code~#2#1#3}
\Crefformat{lstlisting}{Code~#2#1#3}

\usepackage[list=false,lofdepth,lotdepth]{subfig}
\usepackage{sparklines}

% ------------------------------------- %
% ---------- COMMANDES PERSO ---------- %
% ------------------------------------- %
% ######### TABLES AVEC FIGURES #########
\newcolumntype{M}[1]{>{\centering\arraybackslash}m{#1}}
\newcolumntype{N}{@{}m{0pt}@{}}
\newcolumntype{P}[1]{>{\centering\arraybackslash}p{#1}}
\usepackage{tikz}
\usepackage{makecell}
\usetikzlibrary{calc,shapes,arrows}
\newcommand{\tikzmark}[1]{%
	\tikz[overlay,remember picture] \node (#1) {};}
% ############# SCHEMAS TIKZ ###########
\usepackage{tikz}
\usetikzlibrary{shapes,arrows.meta, shapes.geometric, positioning, patterns}
\usepackage{dashbox}

%%% TABLES
\usepackage{verbatim}
\usepackage{makecell}
\usepackage{multirow}

\usepackage{upgreek}

\crefname{paragraph}{paragraphe}{paragraphes}
\Crefname{paragraph}{Paragraphe}{Paragraphes}

\makeatletter
\DeclareRobustCommand{\cnameref}[1]{%
%	\namecref{#1}
	\nameref{#1}%
}%
\DeclareRobustCommand{\Cnameref}[1]{%
	\nameCref{#1} \nameref{#1}%
}

% ###### CREATION D'ENCADRES ###### %

% Encadré pris dans la thèse de Seb Rey
\usepackage{tcolorbox}
\tcbuselibrary{theorems, skins, breakable}
%\newtcb
\newtcbtheorem[auto counter, number within=chapter, Crefname={Encadré}{Encadré}, crefname={encadré}{encadré}, list inside={listencadres}]{encadre}{Encadré}{
	outer arc=0pt,
	arc=0pt,
	breakable,
	enhanced,
	parbox=false,
	colback=white,
	colframe=black,
	colbacktitle=white,
	titlerule=0pt,
	fonttitle=\normalcolor\itshape}{enc}

% A utiliser avec \usepackage{cleveref}
%\crefformat{tcb@cnt@encadre}{encadré~#2#1#3}
%\Crefformat{tcb@cnt@encadre}{Encadré~#2#1#3}

%%% UTILISATION %%%
% \begin{encadre}{Titre de l'encadré}{label-de-lencadre}
% \renewcommand{\thempfootnote}{\alph{mpfootnote}} % permet d'avoir des ndbp en lettres, sans affecter le reste des ndbp
% Contenu de l'encadré
%\end{encadre}
% Référence interne dans le texte :\cref{enc:label-de-lencadre}


\usepackage{titlesec} % Pose problème avec les headers
% Corrigé avec ce code, à mettre pour chaque section
%\let\orisectionmark\sectionmark
%\renewcommand\sectionmark[1]{}%
%\section[Titre TOC]{Titre dans texte}
%\orisectionmark{Titre header}
%\let\sectionmark\orisectionmark

\titlespacing\section{0pt}{16pt plus 4pt minus 2pt}{0pt plus 2pt minus 2pt}
\titlespacing\subsection{0pt}{11pt plus 4pt minus 2pt}{0pt plus 2pt minus 2pt}
\titlespacing\subsubsection{0pt}{11pt plus 4pt minus 2pt}{0pt plus 2pt minus 2pt}
\titlespacing\paragraph{2em}{6pt plus 2pt minus 2pt}{8pt plus 0pt minus 0pt}
\newcommand{\sectionbreak}{\clearpage} % Clearpage avant chaque nouvelle section



% ######### PLAN DETAILLE #########
% Make a TOC without line number when calling \tableofcontents
%\let\Contentsline\contentsline
%\renewcommand\contentsline[3]{\Contentsline{#1}{#2}{}}
\usepackage{pbox}
\usepackage{array}% http://ctan.org/pkg/array



% ###### AVANT-PROPOS CHAP2 ######
\usepackage{multicol}


% ######## Plusieurs ndbp renvoyant à la même ######
\usepackage[bottom]{footmisc}
% # Et on met un asterisque à la place
\newcommand{\astfootnote}[1]{
	\let\oldthefootnote=\thefootnote
	\setcounter{footnote}{0}
	\renewcommand{\thefootnote}{\fnsymbol{footnote}}
	\hspace*{-.45cm}\footnote{#1}\unskip
	\let\thefootnote=\oldthefootnote
}

% ############ CITATIONS #############
% Citer juste le prénom + nom d'une référence
\newrobustcmd*{\citeauteur}{\AtNextCite{\DeclareNameAlias{labelname}{first-last}}\citeauthor}
% \citeauteur{ref}


% PAGES BLANCHES
%\usepackage{afterpage}
%\newcommand\blankpage{%
%	\null
%	\thispagestyle{empty}%
%	\addtocounter{page}{-1}%
%	\newpage}
% Usage : \afterpage{\null\newpage}

% ######### TITRE #########
\usepackage{titling}
\title{Modéliser des systèmes de peuplement en interdisciplinarité. Co-construction et exploration visuelle d’un modèle de simulation}
\author{Robin Cura}
\date{\vspace{-5ex}}
\makeatletter
\newcommand*{\toccontents}{\@starttoc{toc}}
\makeatother

%\usepackage{blindtext}

\newcommand{\simfeodal}{\textsc{SimFeodal}}
\newcommand{\simedb}{\textsc{SimEDB}}


\emergencystretch=1cm


%%%%%%% ANNNEXES %%%%%%%
\usepackage[toc,title]{appendix}
\renewcommand{\appendixtocname}{Annexes}
\renewcommand{\appendixpagename}{Annexes} 
\crefname{appchap}{annexe}{annexes}
\Crefname{appchap}{Annexe}{Annexes}

\usepackage{pdfpages}
\usepackage{etoolbox}